function e(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function t({strategyTemplate:e,strategies:t}){return function(e){let t,s="and";const n=e.replace("&&","&").replace("||","|");for(const e of n)if(" "!==e&&("&"===e&&(s="and"),"|"===e&&(s="or"),!isNaN(e))){const n=parseInt(e);if(t=void 0===t?n:"and"===s?t&n:t|n,"or"===s&&1===t)return!0}return!!t}(e.replace(/{{(\d+)}}/g,((e,s)=>t[s]?t[s].resolveAble?1:0:e)))}function s(e,t){const s={type:t,resolveAble:!1};if(e.length>t.length){const n=e.slice(t.length).trim();if(n.startsWith("('")&&n.endsWith("')")){const e=n.slice(2,-2);s.options=e}}return"onIdle"!==t&&"onDelay"!==t&&"onClientLoad"!==t||(s.resolveAble=!0),s}function n(e){const t=function(e){const t=[];let s="";for(const n of e.split(""))"&"===n&&s.endsWith("&")||"|"===n&&s.endsWith("|")?(t.push(s.slice(0,-1).trim()),t.push(n.repeat(2)),s=""):s+=n;return s&&t.push(s.trim()),t}(e),n={strategyAttribute:e,strategies:[],strategyTemplate:""};let i=0;for(const[e,o]of t.entries()){const r=o.includes("(")?o.substring(0,o.indexOf("(")):o;switch(r){case"onClientLoad":case"onClick":case"onFocus":case"onHover":case"onMedia":case"onVisible":case"onIdle":case"onDelay":n.strategies.push(s(o,r)),t[e]=`{{${i}}}`,i+=1}}return n.strategyTemplate=t.join(" "),n}const i={"rocket-rotating-text":()=>import("./92c9ee79.js").then((e=>e.RocketRotatingText))},o=new class{constructor(t){e(this,"components",{}),e(this,"isSetup",!1),e(this,"elements",[]),e(this,"mediaQueries",{}),this.components=t}async checkElement(e,{composedPath:s,event:n}={}){const i=this.elements[e];if(i.deleteMe)return{needsCleanup:!0};if(t({strategyTemplate:i.strategyTemplate,strategies:i.strategies})){await this.setup();const e=this.components[i.tagName];if(e){const t=await e();customElements.define(i.tagName,t)}i.node.updateComplete&&await i.node.updateComplete;for(let e=0;e<this.elements.length;e+=1)this.elements[e].tagName===i.tagName&&(this.elements[e].deleteMe=!0);if(s&&n){const e=s[0];e&&e.dispatchEvent(n)}return{needsCleanup:!0}}return{needsCleanup:!1}}cleanup(){for(let e=this.elements.length-1;e>=0;e--)this.elements[e].deleteMe&&(this.intersectionObserver&&this.elements[e].strategies.some((e=>"onVisible"===e.type))&&this.intersectionObserver.unobserve(this.elements[e].node),this.elements.splice(e,1))}gatherElements(){const e=document.querySelectorAll("[loading]"),t=[];for(const s of e){const e=s.getAttribute("loading");if(!e)continue;const i=s.tagName.toLowerCase();if(e.startsWith("hydrate:")){const o=n(e.substring(8));t.push({tagName:i,node:s,...o})}}return t}async setResolveAbleOn({target:e,strategyType:t,strategyOptions:s,resolveAble:n},i={}){let o=!1;const r=this.elements.findIndex((t=>t.node===e&&!t.deleteMe));if(-1!==r)for(let e=0;e<this.elements[r].strategies.length;e+=1)this.elements[r].strategies[e].type===t&&this.elements[r].strategies[e].options===s&&(this.elements[r].strategies[e].resolveAble=n,({needsCleanup:o}=await this.checkElement(r,i)));o&&this.cleanup()}async init(){if(0===Object.keys(this.components).length)return;this.elements=this.gatherElements();let e=!1;for(let t=0;t<this.elements.length;t+=1)({needsCleanup:e}=await this.checkElement(t));e&&await this.cleanup(),await this.handleOnVisible(),await this.handleOnClick(),await this.handleOnFocus(),await this.handleOnMedia()}async handleOnMedia(){for(const e of this.elements)for(const t of e.strategies)"onMedia"===t.type&&t.options&&(this.mediaQueries[t.options]||(this.mediaQueries[t.options]=window.matchMedia(t.options)),this.mediaQueries[t.options].addEventListener("change",(s=>{s.matches?this.setResolveAbleOn({target:e.node,strategyType:t.type,strategyOptions:t.options,resolveAble:!0}):this.setResolveAbleOn({target:e.node,strategyType:t.type,strategyOptions:t.options,resolveAble:!1})})),this.mediaQueries[t.options].matches&&this.setResolveAbleOn({target:e.node,strategyType:t.type,strategyOptions:t.options,resolveAble:!0}))}async handleOnClick(){document.body.addEventListener("click",(async e=>{e.target&&(this.setResolveAbleOn({target:e.target,strategyType:"onClick",resolveAble:!0},{composedPath:e.composedPath(),event:e}),setTimeout((()=>{e.target&&this.setResolveAbleOn({target:e.target,strategyType:"onClick",resolveAble:!1})}),10))}))}async handleOnFocus(){document.body.addEventListener("focusin",(async e=>{e.target&&(this.setResolveAbleOn({target:e.target,strategyType:"onFocus",resolveAble:!0},{composedPath:e.composedPath(),event:e}),setTimeout((()=>{e.target&&this.setResolveAbleOn({target:e.target,strategyType:"onFocus",resolveAble:!1})}),10))}))}async handleOnVisible(){this.intersectionObserver=new IntersectionObserver((e=>{for(const t of e)t.isIntersecting?this.setResolveAbleOn({target:t.target,strategyType:"onVisible",resolveAble:!0}):this.setResolveAbleOn({target:t.target,strategyType:"onVisible",resolveAble:!1})}));for(const e of this.elements)for(const t of e.strategies)"onVisible"===t.type&&this.intersectionObserver.observe(e.node)}async setup(){if(!1===this.isSetup){const e=import("./7848decb.js");if(!HTMLTemplateElement.prototype.hasOwnProperty("shadowRoot")){const{hydrateShadowRoots:e}=await import("./08fd9d8d.js");e(document.body),document.body.removeAttribute("dsd-pending")}await e,this.isSetup=!0}}}(i);window.__ROCKET_HYDRATION_LOADER__=o,await o.init();export{e as _};
